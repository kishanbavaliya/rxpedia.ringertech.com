"use strict";
(self["webpackChunk"] = self["webpackChunk"] || []).push([["Dead_Stock_Report"],{

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=script&lang=js"
/*!*************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=script&lang=js ***!
  \*************************************************************************************************************************************************************************************************************************/
(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var nprogress__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nprogress */ "./node_modules/nprogress/nprogress.js");
/* harmony import */ var nprogress__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(nprogress__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var vuex__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! vuex */ "./node_modules/vuex/dist/vuex.esm.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _regenerator() { /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ var e, t, r = "function" == typeof Symbol ? Symbol : {}, n = r.iterator || "@@iterator", o = r.toStringTag || "@@toStringTag"; function i(r, n, o, i) { var c = n && n.prototype instanceof Generator ? n : Generator, u = Object.create(c.prototype); return _regeneratorDefine2(u, "_invoke", function (r, n, o) { var i, c, u, f = 0, p = o || [], y = !1, G = { p: 0, n: 0, v: e, a: d, f: d.bind(e, 4), d: function d(t, r) { return i = t, c = 0, u = e, G.n = r, a; } }; function d(r, n) { for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) { var o, i = p[t], d = G.p, l = i[2]; r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0)); } if (o || r > 1) return a; throw y = !0, n; } return function (o, p, l) { if (f > 1) throw TypeError("Generator is already running"); for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) { i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u); try { if (f = 2, i) { if (c || (o = "next"), t = i[o]) { if (!(t = t.call(i, u))) throw TypeError("iterator result is not an object"); if (!t.done) return t; u = t.value, c < 2 && (c = 0); } else 1 === c && (t = i["return"]) && t.call(i), c < 2 && (u = TypeError("The iterator does not provide a '" + o + "' method"), c = 1); i = e; } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break; } catch (t) { i = e, c = 1, u = t; } finally { f = 1; } } return { value: t, done: y }; }; }(r, o, i), !0), u; } var a = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} t = Object.getPrototypeOf; var c = [][n] ? t(t([][n]())) : (_regeneratorDefine2(t = {}, n, function () { return this; }), t), u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c); function f(e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, _regeneratorDefine2(e, o, "GeneratorFunction")), e.prototype = Object.create(u), e; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, _regeneratorDefine2(u, "constructor", GeneratorFunctionPrototype), _regeneratorDefine2(GeneratorFunctionPrototype, "constructor", GeneratorFunction), GeneratorFunction.displayName = "GeneratorFunction", _regeneratorDefine2(GeneratorFunctionPrototype, o, "GeneratorFunction"), _regeneratorDefine2(u), _regeneratorDefine2(u, o, "Generator"), _regeneratorDefine2(u, n, function () { return this; }), _regeneratorDefine2(u, "toString", function () { return "[object Generator]"; }), (_regenerator = function _regenerator() { return { w: i, m: f }; })(); }
function _regeneratorDefine2(e, r, n, t) { var i = Object.defineProperty; try { i({}, "", {}); } catch (e) { i = 0; } _regeneratorDefine2 = function _regeneratorDefine(e, r, n, t) { function o(r, n) { _regeneratorDefine2(e, r, function (e) { return this._invoke(r, n, e); }); } r ? i ? i(e, r, { value: n, enumerable: !t, configurable: !t, writable: !t }) : e[r] = n : (o("next", 0), o("throw", 1), o("return", 2)); }, _regeneratorDefine2(e, r, n, t); }
function asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }
function _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, "next", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, "throw", n); } _next(void 0); }); }; }
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }


// axios assumed globally available

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
  metaInfo: {
    title: 'Dead Stock Report'
  },
  data: function data() {
    return {
      isLoading: true,
      exporting: false,
      // vue-good-table state
      serverParams: {
        sort: {
          field: 'days_since_last_movement',
          type: 'desc'
        },
        page: 1,
        perPage: 10 // -1 when All is chosen
      },
      tableKey: 0,
      // force re-render on stubborn VGT builds
      limit: 10,
      // mirrors perPage for server (–1 for All)
      search: '',
      totalRows: 0,
      range: {
        from: 0,
        to: 0
      },
      // provided by backend

      rows: [{
        children: []
      }],
      period: 60,
      periodOptions: [{
        value: 30,
        text: this.$t('Last_30_days')
      }, {
        value: 60,
        text: this.$t('Last_60_days')
      }, {
        value: 90,
        text: this.$t('Last_90_days')
      }],
      // optional filters
      warehouse_id: null,
      brand_id: null,
      category_id: null,
      // axios cancel between rapid interactions
      _cancelSource: null
    };
  },
  computed: _objectSpread(_objectSpread({}, (0,vuex__WEBPACK_IMPORTED_MODULE_1__.mapGetters)(['currentUser'])), {}, {
    columns: function columns() {
      return [{
        label: this.$t('Code'),
        field: 'code',
        sortable: true,
        tdClass: 'text-left',
        thClass: 'text-left'
      }, {
        label: this.$t('Product'),
        field: 'product_name',
        sortable: true,
        tdClass: 'text-left',
        thClass: 'text-left'
      }, {
        label: this.$t('OnHand'),
        field: 'on_hand',
        type: 'number',
        headerField: this.sumOnHand,
        sortable: true,
        tdClass: 'text-left',
        thClass: 'text-left'
      }, {
        label: this.$t('LastMovement'),
        field: 'last_movement_at',
        sortable: true,
        tdClass: 'text-left',
        thClass: 'text-left'
      }, {
        label: this.$t('DaysSinceLastMovement'),
        field: 'days_since_last_movement',
        type: 'number',
        sortable: true,
        tdClass: 'text-left',
        thClass: 'text-left'
      }];
    },
    paginationOptions: function paginationOptions() {
      return {
        enabled: true,
        mode: 'records',
        perPage: this.serverParams.perPage,
        // -1 when All
        perPageDropdown: [10, 20, 50, 100],
        dropdownAllowAll: true,
        // adds “All” (value -1)
        allText: 'All',
        allLabel: 'All',
        nextLabel: 'next',
        prevLabel: 'prev',
        setCurrentPage: this.serverParams.page
      };
    },
    disableExport: function disableExport() {
      return this.isLoading || this.exporting || !this.totalRows;
    }
  }),
  methods: {
    sumOnHand: function sumOnHand(groupRow) {
      var sum = 0;
      var rows = (groupRow === null || groupRow === void 0 ? void 0 : groupRow.children) || [];
      for (var i = 0; i < rows.length; i++) {
        var v = Number(rows[i].on_hand || 0);
        if (!isNaN(v)) sum += v;
      }
      return sum;
    },
    updateParams: function updateParams(newProps) {
      this.serverParams = Object.assign({}, this.serverParams, newProps);
    },
    resetToFirstPageAndFetch: function resetToFirstPageAndFetch() {
      var _this$$refs$vgt;
      this.updateParams({
        page: 1
      });
      if ((_this$$refs$vgt = this.$refs.vgt) !== null && _this$$refs$vgt !== void 0 && _this$$refs$vgt.changePage) this.$refs.vgt.changePage(1);
      this.fetchDeadStock(1);
    },
    onPageChange: function onPageChange(_ref) {
      var currentPage = _ref.currentPage;
      this.updateParams({
        page: currentPage
      });
      this.fetchDeadStock(currentPage);
    },
    onPerPageChange: function onPerPageChange(_ref2) {
      var _this$$refs$vgt2;
      var currentPerPage = _ref2.currentPerPage;
      this.limit = currentPerPage; // -1 means All (server)
      this.updateParams({
        perPage: currentPerPage,
        page: 1
      });
      if ((_this$$refs$vgt2 = this.$refs.vgt) !== null && _this$$refs$vgt2 !== void 0 && _this$$refs$vgt2.changePage) this.$refs.vgt.changePage(1);
      this.fetchDeadStock(1);
    },
    onSortChange: function onSortChange(params) {
      if (params && params[0]) {
        this.updateParams({
          sort: {
            type: params[0].type,
            field: params[0].field
          }
        });
        this.fetchDeadStock(this.serverParams.page);
      }
    },
    onSearch: function onSearch(value) {
      this.search = value.searchTerm || '';
      this.resetToFirstPageAndFetch();
    },
    onPeriodChange: function onPeriodChange() {
      this.resetToFirstPageAndFetch();
    },
    _buildQuery: function _buildQuery() {
      var _ref4;
      var _ref3 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
        page = _ref3.page,
        _ref3$limitOverride = _ref3.limitOverride,
        limitOverride = _ref3$limitOverride === void 0 ? null : _ref3$limitOverride;
      var qp = new URLSearchParams({
        page: String((_ref4 = page !== null && page !== void 0 ? page : this.serverParams.page) !== null && _ref4 !== void 0 ? _ref4 : 1),
        SortField: this.serverParams.sort.field || 'days_since_last_movement',
        SortType: this.serverParams.sort.type || 'desc',
        search: this.search || '',
        limit: String(limitOverride !== null ? limitOverride : this.limit),
        // -1 means All
        period: String(this.period)
      });
      if (this.warehouse_id) qp.append('warehouse_id', this.warehouse_id);
      if (this.brand_id) qp.append('brand_id', this.brand_id);
      if (this.category_id) qp.append('category_id', this.category_id);
      return qp;
    },
    fetchDeadStock: function fetchDeadStock() {
      var _arguments = arguments,
        _this = this;
      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {
        var page, qp, config, _yield$axios$get, data, items, r, _axios$isCancel, _axios, _this$$bvToast, _t;
        return _regenerator().w(function (_context) {
          while (1) switch (_context.p = _context.n) {
            case 0:
              page = _arguments.length > 0 && _arguments[0] !== undefined ? _arguments[0] : 1;
              // cancel previous in-flight request (if any)
              if (_this._cancelSource && typeof _this._cancelSource.cancel === 'function') {
                _this._cancelSource.cancel('New request triggered');
              }
              _this._cancelSource = axios.CancelToken ? axios.CancelToken.source() : null;
              nprogress__WEBPACK_IMPORTED_MODULE_0___default().start();
              nprogress__WEBPACK_IMPORTED_MODULE_0___default().set(0.1);
              _this.isLoading = true;
              _context.p = 1;
              qp = _this._buildQuery({
                page: page
              });
              config = _this._cancelSource ? {
                cancelToken: _this._cancelSource.token
              } : {};
              _context.n = 2;
              return axios.get("report/dead_stock?".concat(qp.toString()), config);
            case 2:
              _yield$axios$get = _context.v;
              data = _yield$axios$get.data;
              items = Array.isArray(data.report) ? data.report : [];
              _this.totalRows = Number(data.totalRows || 0);
              _this.rows[0].children = items;
              r = data.range || {};
              _this.range = {
                from: Number(r.from || (_this.totalRows ? 1 : 0)),
                to: Number(r.to || Math.min(_this.totalRows, (_this.serverParams.page - 1) * (_this.serverParams.perPage === -1 ? _this.totalRows : _this.serverParams.perPage) + items.length))
              };

              // repaint in case VGT caches header/footer labels
              _this.tableKey += 1;
              _context.n = 4;
              break;
            case 3:
              _context.p = 3;
              _t = _context.v;
              // ignore cancellations
              if (!((_axios$isCancel = (_axios = axios).isCancel) !== null && _axios$isCancel !== void 0 && _axios$isCancel.call(_axios, _t))) {
                (_this$$bvToast = _this.$bvToast) === null || _this$$bvToast === void 0 || _this$$bvToast.toast(_this.$t('UnexpectedError') || 'Unexpected error.', {
                  variant: 'danger',
                  solid: true
                });
                // eslint-disable-next-line no-console
                console.error('Dead stock fetch error:', _t);
              }
            case 4:
              _context.p = 4;
              nprogress__WEBPACK_IMPORTED_MODULE_0___default().done();
              _this.isLoading = false;
              return _context.f(4);
            case 5:
              return _context.a(2);
          }
        }, _callee, null, [[1, 3, 4, 5]]);
      }))();
    },
    // -------- PDF Export (current page) --------
    exportPdf: function exportPdf() {
      var _this2 = this;
      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2() {
        var _this2$rows, items, _this2$$bvToast, _t2;
        return _regenerator().w(function (_context2) {
          while (1) switch (_context2.p = _context2.n) {
            case 0:
              if (!_this2.disableExport) {
                _context2.n = 1;
                break;
              }
              return _context2.a(2);
            case 1:
              _this2.exporting = true;
              _context2.p = 2;
              items = ((_this2$rows = _this2.rows) === null || _this2$rows === void 0 || (_this2$rows = _this2$rows[0]) === null || _this2$rows === void 0 ? void 0 : _this2$rows.children) || [];
              _context2.n = 3;
              return _this2._buildAndSavePdf(items, {
                suffix: 'page'
              });
            case 3:
              _context2.n = 5;
              break;
            case 4:
              _context2.p = 4;
              _t2 = _context2.v;
              (_this2$$bvToast = _this2.$bvToast) === null || _this2$$bvToast === void 0 || _this2$$bvToast.toast(_this2.$t ? _this2.$t('Export_Failed') : 'Export failed. Please try again.', {
                variant: 'danger',
                solid: true
              });
              // eslint-disable-next-line no-console
              console.error('PDF export error:', _t2);
            case 5:
              _context2.p = 5;
              _this2.exporting = false;
              return _context2.f(5);
            case 6:
              return _context2.a(2);
          }
        }, _callee2, null, [[2, 4, 5, 6]]);
      }))();
    },
    // -------- PDF Export (ALL rows) --------
    exportPdfAll: function exportPdfAll() {
      var _this3 = this;
      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee3() {
        var _this3$_buildQuery, _this3$serverParams, _this3$serverParams2, qp, _yield$axios$get2, data, items, _this3$$bvToast, _t3;
        return _regenerator().w(function (_context3) {
          while (1) switch (_context3.p = _context3.n) {
            case 0:
              if (!_this3.disableExport) {
                _context3.n = 1;
                break;
              }
              return _context3.a(2);
            case 1:
              _this3.exporting = true;
              nprogress__WEBPACK_IMPORTED_MODULE_0___default().start();
              nprogress__WEBPACK_IMPORTED_MODULE_0___default().set(0.2);
              _context3.p = 2;
              qp = ((_this3$_buildQuery = _this3._buildQuery) === null || _this3$_buildQuery === void 0 ? void 0 : _this3$_buildQuery.call(_this3, {
                page: 1,
                limitOverride: -1
              })) || new URLSearchParams({
                page: '1',
                limit: '-1',
                SortField: ((_this3$serverParams = _this3.serverParams) === null || _this3$serverParams === void 0 || (_this3$serverParams = _this3$serverParams.sort) === null || _this3$serverParams === void 0 ? void 0 : _this3$serverParams.field) || 'last_movement_at',
                SortType: ((_this3$serverParams2 = _this3.serverParams) === null || _this3$serverParams2 === void 0 || (_this3$serverParams2 = _this3$serverParams2.sort) === null || _this3$serverParams2 === void 0 ? void 0 : _this3$serverParams2.type) || 'asc',
                search: _this3.search || '',
                period: String(_this3.period),
                warehouse_id: _this3.warehouse_id || '',
                brand_id: _this3.brand_id || '',
                category_id: _this3.category_id || ''
              });
              _context3.n = 3;
              return axios.get("report/dead_stock?".concat(qp.toString()));
            case 3:
              _yield$axios$get2 = _context3.v;
              data = _yield$axios$get2.data;
              items = Array.isArray(data === null || data === void 0 ? void 0 : data.report) ? data.report : [];
              _context3.n = 4;
              return _this3._buildAndSavePdf(items, {
                suffix: 'all'
              });
            case 4:
              _context3.n = 6;
              break;
            case 5:
              _context3.p = 5;
              _t3 = _context3.v;
              (_this3$$bvToast = _this3.$bvToast) === null || _this3$$bvToast === void 0 || _this3$$bvToast.toast(_this3.$t ? _this3.$t('Export_Failed') : 'Export failed. Please try again.', {
                variant: 'danger',
                solid: true
              });
              // eslint-disable-next-line no-console
              console.error('PDF export all error:', _t3);
            case 6:
              _context3.p = 6;
              nprogress__WEBPACK_IMPORTED_MODULE_0___default().done();
              _this3.exporting = false;
              return _context3.f(6);
            case 7:
              return _context3.a(2);
          }
        }, _callee3, null, [[2, 5, 6, 7]]);
      }))();
    },
    // -------- Shared PDF builder (RTL + Vazirmatn-Bold) --------
    _buildAndSavePdf: function _buildAndSavePdf(items) {
      var _arguments2 = arguments,
        _this4 = this;
      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee4() {
        var _find;
        var _ref5, _ref5$suffix, suffix, _yield$import, jsPDF, autoTable, doc, fontPath, rtl, t, title, periodLabel, getLabel, warehouseLabel, brandLabel, categoryLabel, margin, pageW, filtersLine, wrapped, hCode, hProd, hOH, hLast, hDays, never, head, body, stamp, file;
        return _regenerator().w(function (_context4) {
          while (1) switch (_context4.n) {
            case 0:
              _ref5 = _arguments2.length > 1 && _arguments2[1] !== undefined ? _arguments2[1] : {}, _ref5$suffix = _ref5.suffix, suffix = _ref5$suffix === void 0 ? 'page' : _ref5$suffix;
              _context4.n = 1;
              return __webpack_require__.e(/*! import() */ "node_modules_jspdf_dist_jspdf_es_min_js").then(__webpack_require__.bind(__webpack_require__, /*! jspdf */ "./node_modules/jspdf/dist/jspdf.es.min.js"));
            case 1:
              _yield$import = _context4.v;
              jsPDF = _yield$import.jsPDF;
              _context4.n = 2;
              return __webpack_require__.e(/*! import() */ "node_modules_jspdf-autotable_dist_jspdf_plugin_autotable_mjs").then(__webpack_require__.bind(__webpack_require__, /*! jspdf-autotable */ "./node_modules/jspdf-autotable/dist/jspdf.plugin.autotable.mjs"));
            case 2:
              autoTable = _context4.v["default"];
              doc = new jsPDF({
                orientation: 'landscape',
                unit: 'pt',
                format: 'A4'
              }); // Font: you said you only have Vazirmatn-Bold -> use it for normal & bold
              fontPath = '/fonts/Vazirmatn-Bold.ttf';
              try {
                doc.addFont(fontPath, 'Vazirmatn', 'normal');
                doc.addFont(fontPath, 'Vazirmatn', 'bold');
              } catch (e) {/* ignore if already added */}
              doc.setFont('Vazirmatn', 'normal');

              // RTL detection
              rtl = _this4.$i18n && ['ar', 'fa', 'ur', 'he'].includes(_this4.$i18n.locale) || typeof document !== 'undefined' && document.documentElement.dir === 'rtl'; // Localized labels (fallback to English)
              t = function t(k, d) {
                return _this4.$t ? _this4.$t(k) : d || k;
              };
              title = t('Dead_Stock_Report', 'Dead Stock Report'); // Period label from your dropdown (already localized in UI)
              periodLabel = ((_find = (_this4.periodOptions || []).find(function (o) {
                return String(o.value) === String(_this4.period);
              })) === null || _find === void 0 ? void 0 : _find.text) || {
                '30': 'Last 30 days',
                '60': 'Last 60 days',
                '90': 'Last 90 days'
              }[String(_this4.period)] || String(_this4.period); // Try to resolve names for filters if lists exist; fallback to ID
              getLabel = function getLabel(list, id) {
                var _found$key;
                var key = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'name';
                if (!id) return t('All', 'All');
                var found = (list || []).find(function (i) {
                  return String(i.id) === String(id);
                });
                return found && ((_found$key = found[key]) !== null && _found$key !== void 0 ? _found$key : found.name) || String(id);
              };
              warehouseLabel = _this4.warehouses ? getLabel(_this4.warehouses, _this4.warehouse_id, 'name') : _this4.warehouse_id || t('All', 'All');
              brandLabel = _this4.brands ? getLabel(_this4.brands, _this4.brand_id, 'name') : _this4.brand_id || null;
              categoryLabel = _this4.categories ? getLabel(_this4.categories, _this4.category_id, 'name') : _this4.category_id || null; // Header
              margin = 40;
              pageW = doc.internal.pageSize.getWidth();
              doc.setFont('Vazirmatn', 'bold');
              doc.setFontSize(16);
              rtl ? doc.text(title, pageW - margin, 36, {
                align: 'right'
              }) : doc.text(title, margin, 36);
              doc.setFont('Vazirmatn', 'normal');
              doc.setFontSize(10);
              filtersLine = ["".concat(t('Period', 'Period'), ": ").concat(periodLabel), _this4.warehouse_id ? "".concat(t('warehouse', 'Warehouse'), ": ").concat(warehouseLabel) : "".concat(t('warehouse', 'Warehouse'), ": ").concat(t('All', 'All')), _this4.brand_id ? "".concat(t('Brand', 'Brand'), ": ").concat(brandLabel) : null, _this4.category_id ? "".concat(t('Category', 'Category'), ": ").concat(categoryLabel) : null, _this4.search ? "".concat(t('Search_this_table', 'Search'), ": \"").concat(_this4.search, "\"") : null].filter(Boolean).join('   •   ');
              wrapped = doc.splitTextToSize(filtersLine, pageW - margin * 2);
              rtl ? doc.text(wrapped, pageW - margin, 56, {
                align: 'right'
              }) : doc.text(wrapped, margin, 56);

              // Columns (localized headers)
              hCode = t('Code', 'Code');
              hProd = t('Product', 'Product');
              hOH = t('OnHand', 'On hand');
              hLast = t('LastMovement', 'Last movement');
              hDays = t('DaysSinceLastMovement', 'Days since last movement');
              never = t('Never_Moved', 'Never Moved');
              head = [[hCode, hProd, hOH, hLast, hDays]]; // Rows
              body = (items || []).map(function (r) {
                var _r$on_hand, _r$last_movement_at, _r$days_since_last_mo;
                return [r.code || '', r.product_name || r.product || '', typeof r.on_hand === 'number' ? String(r.on_hand) : (_r$on_hand = r.on_hand) !== null && _r$on_hand !== void 0 ? _r$on_hand : '', (_r$last_movement_at = r.last_movement_at) !== null && _r$last_movement_at !== void 0 ? _r$last_movement_at : '—', r.last_movement_at ? (_r$days_since_last_mo = r.days_since_last_movement) !== null && _r$days_since_last_mo !== void 0 ? _r$days_since_last_mo : '' : never];
              });
              autoTable(doc, {
                startY: 74,
                head: head,
                body: body,
                margin: {
                  left: margin,
                  right: margin
                },
                theme: 'striped',
                styles: {
                  font: 'Vazirmatn',
                  fontStyle: 'normal',
                  fontSize: 9,
                  cellPadding: 6,
                  overflow: 'linebreak',
                  halign: rtl ? 'right' : 'left'
                },
                headStyles: {
                  font: 'Vazirmatn',
                  fontStyle: 'bold',
                  fillColor: [26, 86, 219],
                  textColor: 255,
                  halign: rtl ? 'right' : 'left'
                },
                columnStyles: {
                  2: {
                    halign: 'right'
                  },
                  // On hand (numeric)
                  4: {
                    halign: 'right'
                  } // Days since last movement (numeric-ish)
                },
                didDrawPage: function didDrawPage(d) {
                  doc.setFont('Vazirmatn', 'normal');
                  doc.setFontSize(8);
                  var ph = doc.internal.pageSize.getHeight();
                  var pn = "".concat(d.pageNumber, " / ").concat(doc.internal.getNumberOfPages());
                  // Footer page number mirrored for RTL
                  rtl ? doc.text(pn, margin, ph - 14, {
                    align: 'left'
                  }) : doc.text(pn, pageW - margin, ph - 14, {
                    align: 'right'
                  });
                }
              });
              stamp = new Date().toISOString().slice(0, 19).replace(/[:T]/g, '-');
              file = "dead_stock_".concat(String(_this4.period), "_").concat(suffix, "_").concat(stamp, ".pdf");
              doc.save(file);
            case 3:
              return _context4.a(2);
          }
        }, _callee4);
      }))();
    }
  },
  created: function created() {
    this.fetchDeadStock(1);
  },
  beforeDestroy: function beforeDestroy() {
    if (this._cancelSource && typeof this._cancelSource.cancel === 'function') {
      this._cancelSource.cancel('Component destroyed');
    }
  }
});

/***/ },

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!./node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[2]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=template&id=bb5e478a"
/*!************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!./node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[2]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=template&id=bb5e478a ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************/
(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   render: () => (/* binding */ render),
/* harmony export */   staticRenderFns: () => (/* binding */ staticRenderFns)
/* harmony export */ });
var render = function render() {
  var _vm = this,
    _c = _vm._self._c;
  return _c('div', {
    staticClass: "main-content"
  }, [_c('breadcumb', {
    attrs: {
      "page": _vm.$t('Dead_Stock_Report'),
      "folder": _vm.$t('Reports')
    }
  }), _vm._v(" "), _vm.isLoading ? _c('div', {
    staticClass: "loading_page spinner spinner-primary mr-3"
  }) : _c('b-card', {
    staticClass: "wrapper"
  }, [_c('div', {
    staticClass: "d-flex flex-wrap align-items-center mb-2"
  }, [_c('div', {
    staticClass: "mr-3 mb-2"
  }, [_c('label', {
    staticClass: "mb-0 mr-2"
  }, [_vm._v(_vm._s(_vm.$t('Period')) + ":")]), _vm._v(" "), _c('b-form-select', {
    staticClass: "w-auto",
    attrs: {
      "options": _vm.periodOptions,
      "size": "sm"
    },
    on: {
      "change": _vm.onPeriodChange
    },
    model: {
      value: _vm.period,
      callback: function callback($$v) {
        _vm.period = $$v;
      },
      expression: "period"
    }
  })], 1), _vm._v(" "), _c('div', {
    staticClass: "ml-auto mb-2"
  }, [_c('b-button', {
    staticClass: "mr-2",
    attrs: {
      "size": "sm",
      "variant": "outline-primary",
      "disabled": _vm.disableExport
    },
    on: {
      "click": _vm.exportPdf
    }
  }, [_vm._v("\n          " + _vm._s(_vm.$t('Export')) + " PDF\n        ")]), _vm._v(" "), _c('b-button', {
    attrs: {
      "size": "sm",
      "variant": "outline-secondary",
      "disabled": _vm.disableExport
    },
    on: {
      "click": _vm.exportPdfAll
    }
  }, [_vm._v("\n          " + _vm._s(_vm.$t('Export')) + " PDF (" + _vm._s(_vm.$t('All')) + ")\n        ")])], 1)]), _vm._v(" "), _c('div', {
    staticClass: "small text-muted mb-2"
  }, [_vm._v("\n      " + _vm._s(_vm.$t('Showing')) + " " + _vm._s(_vm.range.from) + " – " + _vm._s(_vm.range.to) + " " + _vm._s(_vm.$t('of')) + " " + _vm._s(_vm.totalRows) + "\n    ")]), _vm._v(" "), _c('vue-good-table', {
    key: _vm.tableKey,
    ref: "vgt",
    attrs: {
      "mode": "remote",
      "columns": _vm.columns,
      "rows": _vm.rows,
      "totalRows": _vm.totalRows,
      "group-options": {
        enabled: true,
        headerPosition: 'bottom'
      },
      "pagination-options": _vm.paginationOptions,
      "search-options": {
        placeholder: _vm.$t('Search_this_table'),
        enabled: true
      },
      "styleClass": "tableOne table-hover vgt-table mt-2"
    },
    on: {
      "on-page-change": _vm.onPageChange,
      "on-per-page-change": _vm.onPerPageChange,
      "on-sort-change": _vm.onSortChange,
      "on-search": _vm.onSearch
    },
    scopedSlots: _vm._u([{
      key: "table-row",
      fn: function fn(props) {
        return [props.column.field === 'last_movement_at' ? _c('span', [_vm._v("\n          " + _vm._s(props.row.last_movement_at || '—') + "\n        ")]) : props.column.field === 'days_since_last_movement' ? _c('span', [!props.row.last_movement_at ? _c('b-badge', {
          attrs: {
            "variant": "warning"
          }
        }, [_vm._v("\n            " + _vm._s(_vm.$t('Never_Moved')) + "\n          ")]) : _c('span', [_vm._v(_vm._s(props.row.days_since_last_movement))])], 1) : _c('span', [_vm._v("\n          " + _vm._s(props.formattedRow[props.column.field]) + "\n        ")])];
      }
    }])
  })], 1)], 1);
};
var staticRenderFns = [];
render._withStripped = true;


/***/ },

/***/ "./resources/src/views/app/pages/reports/Dead_Stock_Report.vue"
/*!*********************************************************************!*\
  !*** ./resources/src/views/app/pages/reports/Dead_Stock_Report.vue ***!
  \*********************************************************************/
(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Dead_Stock_Report_vue_vue_type_template_id_bb5e478a__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Dead_Stock_Report.vue?vue&type=template&id=bb5e478a */ "./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=template&id=bb5e478a");
/* harmony import */ var _Dead_Stock_Report_vue_vue_type_script_lang_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Dead_Stock_Report.vue?vue&type=script&lang=js */ "./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=script&lang=js");
/* harmony import */ var _node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */ "./node_modules/vue-loader/lib/runtime/componentNormalizer.js");





/* normalize component */
;
var component = (0,_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__["default"])(
  _Dead_Stock_Report_vue_vue_type_script_lang_js__WEBPACK_IMPORTED_MODULE_1__["default"],
  _Dead_Stock_Report_vue_vue_type_template_id_bb5e478a__WEBPACK_IMPORTED_MODULE_0__.render,
  _Dead_Stock_Report_vue_vue_type_template_id_bb5e478a__WEBPACK_IMPORTED_MODULE_0__.staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* hot reload */
if (false) // removed by dead control flow
{ var api; }
component.options.__file = "resources/src/views/app/pages/reports/Dead_Stock_Report.vue"
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (component.exports);

/***/ },

/***/ "./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=script&lang=js"
/*!*********************************************************************************************!*\
  !*** ./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=script&lang=js ***!
  \*********************************************************************************************/
(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _node_modules_babel_loader_lib_index_js_clonedRuleSet_5_use_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Dead_Stock_Report_vue_vue_type_script_lang_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dead_Stock_Report.vue?vue&type=script&lang=js */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=script&lang=js");
 /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_babel_loader_lib_index_js_clonedRuleSet_5_use_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Dead_Stock_Report_vue_vue_type_script_lang_js__WEBPACK_IMPORTED_MODULE_0__["default"]); 

/***/ },

/***/ "./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=template&id=bb5e478a"
/*!***************************************************************************************************!*\
  !*** ./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=template&id=bb5e478a ***!
  \***************************************************************************************************/
(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   render: () => (/* reexport safe */ _node_modules_babel_loader_lib_index_js_clonedRuleSet_5_use_0_node_modules_vue_loader_lib_loaders_templateLoader_js_ruleSet_1_rules_2_node_modules_vue_loader_lib_index_js_vue_loader_options_Dead_Stock_Report_vue_vue_type_template_id_bb5e478a__WEBPACK_IMPORTED_MODULE_0__.render),
/* harmony export */   staticRenderFns: () => (/* reexport safe */ _node_modules_babel_loader_lib_index_js_clonedRuleSet_5_use_0_node_modules_vue_loader_lib_loaders_templateLoader_js_ruleSet_1_rules_2_node_modules_vue_loader_lib_index_js_vue_loader_options_Dead_Stock_Report_vue_vue_type_template_id_bb5e478a__WEBPACK_IMPORTED_MODULE_0__.staticRenderFns)
/* harmony export */ });
/* harmony import */ var _node_modules_babel_loader_lib_index_js_clonedRuleSet_5_use_0_node_modules_vue_loader_lib_loaders_templateLoader_js_ruleSet_1_rules_2_node_modules_vue_loader_lib_index_js_vue_loader_options_Dead_Stock_Report_vue_vue_type_template_id_bb5e478a__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[2]!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dead_Stock_Report.vue?vue&type=template&id=bb5e478a */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!./node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[2]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/src/views/app/pages/reports/Dead_Stock_Report.vue?vue&type=template&id=bb5e478a");


/***/ }

}]);